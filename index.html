<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pedido PanaderÃ­a</title>

<style>
body{
font-family:Arial;
margin:0;
padding:10px;
background:#f5f5f5;
}

.container{
max-width:900px;
margin:auto;
background:white;
padding:15px;
border-radius:15px;
}

.producto{
display:flex;
gap:10px;
margin-bottom:15px;
border-bottom:1px solid #ddd;
padding-bottom:10px;
}

.producto img{
width:130px;
height:130px;
object-fit:cover;
border-radius:10px;
}

.producto-info{flex:1;}

input{
width:100%;
padding:6px;
margin-top:4px;
}

button{
width:100%;
padding:14px;
font-size:18px;
background:#28a745;
color:white;
border:none;
border-radius:10px;
margin-top:15px;
cursor:pointer;
}

@media(max-width:600px){
.producto{
flex-direction:column;
align-items:center;
text-align:center;
}
.producto img{
width:200px;
height:200px;
}
}
</style>
</head>

<body>

<div class="container">

<h2>Pedido PanaderÃ­a</h2>

<label>Nombre del Cliente:</label>
<input id="cliente">

<label>Barrio o Conjunto:</label>
<input id="barrio">

<hr>

<div id="productos"></div>

<button onclick="calcular()">CALCULAR PEDIDO</button>
<button onclick="enviar()">ENVIAR PEDIDO âœ”</button>

<pre id="resultado"></pre>
<pre id="bendaje"></pre>

</div>

<!-- SUPABASE -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>

//// ðŸ‘‰ PEGA AQUÃ TUS DATOS DE SUPABASE
const SUPABASE_URL = "https://vswostjubcxjotpqnzhk.supabase.co";
const SUPABASE_ANON = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZzd29zdGp1YmN4am90cHFuemhrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIyOTAyNDksImV4cCI6MjA4Nzg2NjI0OX0.VIWMJWyubtKj7QCoOybia_Fv2S4sjxFelQz9x1tZKBo";

const { createClient } = supabase;
const db = createClient(SUPABASE_URL, SUPABASE_ANON);

//// ðŸ‘‰ PRODUCTOS
const productos=[

{name:"PAN DE 500",precio:500,bendaje:true,img:"https://via.placeholder.com/150"},
{name:"PAN DE 1.000",precio:1000,bendaje:true,img:"https://via.placeholder.com/150"},
{name:"PAN DE 2.000",precio:2000,bendaje:true,img:"https://via.placeholder.com/150"},
{name:"PAN DE 3.500",precio:3500,bendaje:true,img:"https://via.placeholder.com/150"},

{name:"PAN AGRIDULCE DE 500",precio:500,bendaje:true,img:"https://via.placeholder.com/150"},
{name:"PAN AGRIDULCE DE 1.000",precio:1000,bendaje:true,img:"https://via.placeholder.com/150"},
{name:"PAN ROLLO",precio:500,bendaje:true,img:"https://via.placeholder.com/150"},

{name:"PAN QUESILLO",precio:1200,bendaje:false,img:"https://via.placeholder.com/150"},
{name:"LIBERALES",precio:500,bendaje:false,img:"https://via.placeholder.com/150"},
{name:"CAÃ‘AS",precio:500,bendaje:false,img:"https://via.placeholder.com/150"},
{name:"PAN COCO",precio:500,bendaje:false,img:"https://via.placeholder.com/150"},

{name:"MOGICON DE 500",precio:500,bendaje:true,img:"https://via.placeholder.com/150"},
{name:"MOGICON DE 1.200",precio:1200,bendaje:false,img:"https://via.placeholder.com/150"},
{name:"ROSCON DE 2.500",precio:2500,bendaje:false,img:"https://via.placeholder.com/150"},
{name:"HAWAIANOS",precio:1500,bendaje:false,img:"https://via.placeholder.com/150"},
{name:"CROASANES",precio:1500,bendaje:false,img:"https://via.placeholder.com/150"}

];

//// ðŸ‘‰ MOSTRAR PRODUCTOS
const div=document.getElementById("productos");

productos.forEach((p,i)=>{
div.innerHTML+=`
<div class='producto'>
<img src='${p.img}'>
<div class='producto-info'>
<b>${p.name}</b> ($${formato(p.precio)})<br>

Cantidad:
<input id='cant${i}' type='number' placeholder='0'>

Dinero:
<input id='din${i}' type='number' placeholder='Ej: 5000'>
</div>
</div>`;
});

//// ðŸ‘‰ FORMATO MIL
function formato(num){
return num.toLocaleString("es-CO");
}

//// ðŸ‘‰ CALCULAR
function calcular(){

let total=0;
let texto="CLIENTE: "+document.getElementById("cliente").value+"\n";
texto+="BARRIO: "+document.getElementById("barrio").value+"\n\n";

let bendajeTotal=0;
let textoB="BENDAJE:\n";

productos.forEach((p,i)=>{

let cant=Number(document.getElementById('cant'+i).value);
let din=Number(document.getElementById('din'+i).value);

let subtotal=0;
let panes=0;

if(din>0){
subtotal=din;
panes=Math.floor(din/p.precio);
}
else if(cant>0){
subtotal=cant*p.precio;
panes=cant;
}

if(subtotal>0){

texto+=p.name+" x"+panes+" = $"+formato(subtotal)+"\n";
total+=subtotal;

if(p.bendaje){
let b=subtotal*0.20;
let panesB=Math.round(b/p.precio);
let redondeado=panesB*p.precio;

if(redondeado>0){
bendajeTotal+=redondeado;
textoB+=p.name+" â†’ "+panesB+" panes = $"+formato(redondeado)+"\n";
}
}
}
});

texto+="\nTOTAL PEDIDO = $"+formato(total);
textoB+="\nTOTAL BENDAJE = $"+formato(bendajeTotal);

document.getElementById("resultado").innerText=texto;
document.getElementById("bendaje").innerText=textoB;
}

//// ðŸ‘‰ ENVIAR
async function enviar(){

let cliente=document.getElementById("cliente").value;
let barrio=document.getElementById("barrio").value;
let pedido=document.getElementById("resultado").innerText;

if(!cliente){alert("Falta nombre"); return;}

alert("Pedido guardado âœ”");

// ðŸ‘‰ GUARDAR EN SUPABASE
await db.from("pedidos").insert([
{
cliente:cliente,
barrio:barrio,
pedido:pedido
}
]);

}
</script>
</body>
</html>
